<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Additional Functions for Model Tuning • finetune</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="tidyverse.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><link href="tidyverse-2.css" rel="stylesheet">
<!--optional theme--><link href="tidymodels.css" rel="stylesheet">
<meta property="og:title" content="Additional Functions for Model Tuning">
<meta property="og:description" content="finetune enhances the tune package by providing more 
 specialized methods for finding reasonable values of model tuning parameters. 
 Two racing methods described by Kuhn (2014) &lt;arXiv:1405.6974&gt; are included. An
 iterative search method using generalized simulated annealing (Bohachevsky, 
 Johnson and Stein, 1986) &lt;doi:10.1080/00401706.1986.10488128&gt; is also included.  ">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="index.html">finetune</a>
        <div class="info hidden-xs hidden-sm">
          <span class="partof">part of <a href="https://github.com/tidymodels">tidymodels</a></span>
          <span class="version version-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9002</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="reference/index.html">Reference</a>
</li>
        
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="finetune" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#finetune" class="anchor"></a>finetune</h1></div>
<!-- badges: start -->

<p><code>finetune</code> contains some extra functions for model tuning that extend what is currently in the <code>tune</code> package.</p>
<p>Very rough version of the package right now but it works fairly well. There are two main sets of tools.</p>
<p>Tuning via <em>simulated annealing</em> optimization is another iterative search tool for finding good values:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">tidymodels</span><span class="op">)</span>
<span class="co">#&gt; ── Attaching packages ────────────────────────────────────── tidymodels 0.1.1 ──</span>
<span class="co">#&gt; ✓ broom     0.7.0          ✓ recipes   0.1.14    </span>
<span class="co">#&gt; ✓ dials     0.0.9.9000     ✓ rsample   0.0.8.9000</span>
<span class="co">#&gt; ✓ dplyr     1.0.2          ✓ tibble    3.0.4     </span>
<span class="co">#&gt; ✓ ggplot2   3.3.2          ✓ tidyr     1.1.2     </span>
<span class="co">#&gt; ✓ infer     0.5.2          ✓ tune      0.1.1.9001</span>
<span class="co">#&gt; ✓ modeldata 0.0.2          ✓ workflows 0.2.1.9000</span>
<span class="co">#&gt; ✓ parsnip   0.1.3.9000     ✓ yardstick 0.0.7     </span>
<span class="co">#&gt; ✓ purrr     0.3.4</span>
<span class="co">#&gt; ── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──</span>
<span class="co">#&gt; x purrr::discard() masks scales::discard()</span>
<span class="co">#&gt; x dplyr::filter()  masks stats::filter()</span>
<span class="co">#&gt; x dplyr::lag()     masks stats::lag()</span>
<span class="co">#&gt; x recipes::step()  masks stats::step()</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">finetune</span><span class="op">)</span>

<span class="co"># Syntax very similar to `tune_grid()` or `tune_Bayes()`: </span>

<span class="co">## -----------------------------------------------------------------------------</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">two_class_dat</span>, package <span class="op">=</span> <span class="st">"modeldata"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">6376</span><span class="op">)</span>
<span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu">bootstraps</span><span class="op">(</span><span class="va">two_class_dat</span>, times <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># more resamples usually needed</span>

<span class="co"># optimize an regularized discriminant analysis model</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://discrim.tidymodels.org">discrim</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'discrim'</span>
<span class="co">#&gt; The following object is masked from 'package:dials':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     smoothness</span>
<span class="va">rda_spec</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://discrim.tidymodels.org/reference/discrim_regularized.html">discrim_regularized</a></span><span class="op">(</span>frac_common_cov <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span>, frac_identity <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"klaR"</span><span class="op">)</span>

<span class="co">## -----------------------------------------------------------------------------</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">8300</span><span class="op">)</span>
<span class="va">sa_res</span> <span class="op">&lt;-</span> 
  <span class="va">rda_spec</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="reference/tune_sim_anneal.html">tune_sim_anneal</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, resamples <span class="op">=</span> <span class="va">rs</span>, iter <span class="op">=</span> <span class="fl">20</span>, initial <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; &gt;  Generating a set of 4 initial parameter results</span>
<span class="co">#&gt; Loading required package: MASS</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'MASS'</span>
<span class="co">#&gt; The following object is masked from 'package:dplyr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     select</span>
<span class="co">#&gt; ✓ Initialization complete</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Optimizing roc_auc</span>
<span class="co">#&gt; Initial best: 0.88802</span>
<span class="co">#&gt;  1 ◯ accept suboptimal  roc_auc=0.88454  (+/-0.005114)</span>
<span class="co">#&gt;  2 + better suboptimal  roc_auc=0.88649  (+/-0.005143)</span>
<span class="co">#&gt;  3 ◯ accept suboptimal  roc_auc=0.88499  (+/-0.005126)</span>
<span class="co">#&gt;  4 ◯ accept suboptimal  roc_auc=0.8833   (+/-0.005075)</span>
<span class="co">#&gt;  5 ◯ accept suboptimal  roc_auc=0.87731  (+/-0.004954)</span>
<span class="co">#&gt;  6 + better suboptimal  roc_auc=0.88078  (+/-0.005048)</span>
<span class="co">#&gt;  7 ◯ accept suboptimal  roc_auc=0.88028  (+/-0.005061)</span>
<span class="co">#&gt;  8 x restart from best  roc_auc=0.88474  (+/-0.005052)</span>
<span class="co">#&gt;  9 ◯ accept suboptimal  roc_auc=0.88113  (+/-0.005018)</span>
<span class="co">#&gt; 10 ◯ accept suboptimal  roc_auc=0.87766  (+/-0.004922)</span>
<span class="co">#&gt; 11 + better suboptimal  roc_auc=0.88147  (+/-0.005013)</span>
<span class="co">#&gt; 12 + better suboptimal  roc_auc=0.88781  (+/-0.005152)</span>
<span class="co">#&gt; 13 ─ discard suboptimal roc_auc=0.88125  (+/-0.005021)</span>
<span class="co">#&gt; 14 ─ discard suboptimal roc_auc=0.88363  (+/-0.005089)</span>
<span class="co">#&gt; 15 ─ discard suboptimal roc_auc=0.88158  (+/-0.005025)</span>
<span class="co">#&gt; 16 x restart from best  roc_auc=0.88105  (+/-0.005013)</span>
<span class="co">#&gt; 17 ◯ accept suboptimal  roc_auc=0.88183  (+/-0.005037)</span>
<span class="co">#&gt; 18 + better suboptimal  roc_auc=0.88674  (+/-0.005158)</span>
<span class="co">#&gt; 19 ─ discard suboptimal roc_auc=0.87913  (+/-0.005037)</span>
<span class="co">#&gt; 20 ◯ accept suboptimal  roc_auc=0.88358  (+/-0.005096)</span>
<span class="fu">show_best</span><span class="op">(</span><span class="va">sa_res</span>, metric <span class="op">=</span> <span class="st">"roc_auc"</span>, n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2 x 9</span>
<span class="co">#&gt;   frac_common_cov frac_identity .metric .estimator  mean     n std_err .config</span>
<span class="co">#&gt;             &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  </span>
<span class="co">#&gt; 1          0.0345      0.000182 roc_auc binary     0.888    10 0.00516 Prepro…</span>
<span class="co">#&gt; 2          0.0572      0.00318  roc_auc binary     0.888    10 0.00515 Prepro…</span>
<span class="co">#&gt; # … with 1 more variable: .iter &lt;int&gt;</span></pre></div>
<p>The second set of methods are for “racing”. We start off by doing a small set of resamples for all of the grid points, then statistically testing to see which ones should be dropped or investigated more. The two methods here are based on those should in <a href="https://arxiv.org/abs/1405.6974">Kuhn (2014)</a>.</p>
<p>For example, using an ANOVA-type analysis to filter out parameter combinations:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">511</span><span class="op">)</span>
<span class="va">grid</span> <span class="op">&lt;-</span>
  <span class="va">rda_spec</span> <span class="op">%&gt;%</span>
  <span class="fu">parameters</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">grid_max_entropy</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span>
<span class="va">grid_anova</span> <span class="op">&lt;-</span> <span class="va">rda_spec</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/tune_race_anova.html">tune_race_anova</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, resamples <span class="op">=</span> <span class="va">rs</span>, grid <span class="op">=</span> <span class="va">grid</span><span class="op">)</span>
<span class="co">#&gt; ℹ Racing will maximize the roc_auc metric.</span>
<span class="co">#&gt; ℹ Resamples are analyzed in a random order.</span>
<span class="co">#&gt; ℹ Bootstrap05: 18 eliminated;  2 candidates remain.</span>
<span class="co">#&gt; ℹ Bootstrap07:  0 eliminated;  2 candidates remain.</span>
<span class="co">#&gt; ℹ Bootstrap10:  0 eliminated;  2 candidates remain.</span>
<span class="co">#&gt; ℹ Bootstrap01:  0 eliminated;  2 candidates remain.</span>
<span class="co">#&gt; ℹ Bootstrap08:  0 eliminated;  2 candidates remain.</span>
<span class="co">#&gt; ℹ Bootstrap03:  0 eliminated;  2 candidates remain.</span>
<span class="co">#&gt; ℹ Bootstrap09:  0 eliminated;  2 candidates remain.</span>
<span class="fu">show_best</span><span class="op">(</span><span class="va">grid_anova</span>, metric <span class="op">=</span> <span class="st">"roc_auc"</span>, n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2 x 8</span>
<span class="co">#&gt;   frac_common_cov frac_identity .metric .estimator  mean     n std_err .config  </span>
<span class="co">#&gt;             &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;    </span>
<span class="co">#&gt; 1          0.0164        0.0618 roc_auc binary     0.884    10 0.00511 Preproce…</span>
<span class="co">#&gt; 2          0.327         0.0662 roc_auc binary     0.884    10 0.00503 Preproce…</span></pre></div>
<p><code><a href="reference/tune_race_win_loss.html">tune_race_win_loss()</a></code> can also be used.</p>
<div id="code-of-conduct" class="section level2">
<h2 class="hasAnchor">
<a href="#code-of-conduct" class="anchor"></a>Code of Conduct</h2>
<p>Please note that the finetune project is released with a <a href="https://contributor-covenant.org/version/2/0/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Max Kuhn <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-2402-136X" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://codecov.io/gh/tidymodels/finetune?branch=master"><img src="https://codecov.io/gh/tidymodels/finetune/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://github.com/tidymodels/finetune/actions"><img src="https://github.com/tidymodels/finetune/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="tidyverse">
  <p>finetune is a part of the <strong>tidymodels</strong> ecosystem, a collection of modeling packages designed with common APIs and a shared philosophy.</p>
</div>

<div class="author">
  <p>
    Developed by Max Kuhn.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
</div>

  


  </body>
</html>
